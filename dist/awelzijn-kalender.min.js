/*! awelzijn-kalender v1.0.4 */
"use strict";!function(module){try{module=angular.module("awelzijn.kalender")}catch(e){module=angular.module("awelzijn.kalender",[])}module.factory("AwelzijnKalenderService",[function(){function getDatesInRange(start,end){start=new Date(start),start.setHours(0,0,0,0),end=new Date(end);for(var dates=[];end>=start;)dates.push(start),start=start.addDays(1);return dates}function _genereerKalender(gekozenMaand,activiteitenLijst){angular.forEach(activiteitenLijst,function(activiteit){activiteit.datums=getDatesInRange(activiteit.datumVan,activiteit.datumTot)});var geselecteerdeMaand=new Date(gekozenMaand.getFullYear(),gekozenMaand.getMonth(),1),dagenInHuidigeMaand=genereerDagen(geselecteerdeMaand),kalenderMaand={weken:[]},kalenderDagen=[],dagVanDeWeek=0;return angular.forEach(dagenInHuidigeMaand,function(dag){var activiteiten=[];angular.forEach(activiteitenLijst,function(activiteit){for(var i=0;i<activiteit.datums.length;i++)dag.getTime()==activiteit.datums[i].getTime()&&activiteiten.push(activiteit)});var eersteOfLaatsteVanMaand=1===dag.getDate()||isLaatsteDag(dag);kalenderDagen.push({datum:dag,eersteOfLaatsteVanMaand:eersteOfLaatsteVanMaand,isBuitenBereik:dag.getMonth()!=geselecteerdeMaand.getMonth(),activiteiten:activiteiten}),dagVanDeWeek++,dagVanDeWeek%7==0&&(kalenderMaand.weken.push(kalenderDagen),kalenderDagen=[])}),kalenderMaand}var getDagenInMaand=function(jaar,maand){for(var dagen=[],laatsteDagInMaand=new Date(jaar,maand+1,0).getDate(),i=0;laatsteDagInMaand>i;i++)dagen.push(new Date(jaar,maand,i+1));return dagen},genereerDagen=function(geselecteerdeMaand){var huidigeMaand=new Date(geselecteerdeMaand),dagenInHuidigeMaand=getDagenInMaand(huidigeMaand.getFullYear(),huidigeMaand.getMonth()),vorigeMaand=new Date(huidigeMaand.setMonth(huidigeMaand.getMonth()-1)),dagenInVorigeMaand=getDagenInMaand(vorigeMaand.getFullYear(),vorigeMaand.getMonth()),volgendeMaand=new Date(vorigeMaand.setMonth(vorigeMaand.getMonth()+2)),dagenInVolgendeMaand=getDagenInMaand(volgendeMaand.getFullYear(),volgendeMaand.getMonth()),eersteDagVanDeMaand=7;for(0!=dagenInHuidigeMaand[0].getDay()&&(eersteDagVanDeMaand=dagenInHuidigeMaand[0].getDay()),dagenInVorigeMaand.splice(0,dagenInVorigeMaand.length-(eersteDagVanDeMaand-1)),Array.prototype.push.apply(dagenInVorigeMaand,dagenInHuidigeMaand),dagenInHuidigeMaand=dagenInVorigeMaand;dagenInHuidigeMaand.length%7!=0;)dagenInHuidigeMaand.push(dagenInVolgendeMaand[0]),dagenInVolgendeMaand.splice(0,1);return dagenInHuidigeMaand},isLaatsteDag=function(dt){var test=new Date(dt.getTime());return test.setDate(test.getDate()+1),1===test.getDate()};return{genereerKalender:_genereerKalender}}])}(),Date.prototype.addDays=function(days){var dat=new Date(this.valueOf());return dat.setDate(dat.getDate()+days),dat},function(module){try{module=angular.module("awelzijn.kalender")}catch(e){module=angular.module("awelzijn.kalender",[])}module.directive("aWelzijnKalender",["AwelzijnKalenderService","$timeout",function(kalenderService,$timeout){return{restrict:"E",scope:{activiteiten:"=",gekozenMaand:"=",ngShow:"="},replace:!0,templateUrl:"templates/template.html",bindToController:!0,controllerAs:"ctrl",controller:function($scope,$element,$attrs){var ctrl=this,alligneerBijVolgendeShow=!0;$scope.$watch("ctrl.ngShow",function(value){value&&ctrl.kalender&&alligneerBijVolgendeShow&&($timeout(function(){alligneerKalender()}),alligneerBijVolgendeShow=!1)}),$scope.$watch("ctrl.activiteiten",function(value){value&&(ctrl.kalender=kalenderService.genereerKalender(ctrl.gekozenMaand,ctrl.activiteiten),ctrl.gekozenMaand.getMonth()===(new Date).getMonth()?selecteerVandaag():ctrl.geselecteerdeDag=null,angular.isDefined(ctrl.ngShow)&&ctrl.ngShow!==!0?alligneerBijVolgendeShow=!0:$timeout(function(){alligneerKalender()}))});var selecteerVandaag=function(){var vandaag=new Date;vandaag.setHours(0,0,0,0),angular.forEach(ctrl.kalender.weken,function(week){angular.forEach(week,function(dag){dag.datum.getTime()===vandaag.getTime()&&(ctrl.geselecteerdeDag=dag)})})},alligneerKalender=function(){var activiteitenIds=_.pluck(ctrl.activiteiten,"id");angular.forEach(activiteitenIds,function(id){var balkskesVoorActiviteit=$(".kalender td div."+id);balkskesVoorActiviteit.css("background-color","#43A047"),balkskesVoorActiviteit.hover(function(){balkskesVoorActiviteit.fadeTo(0,.8)},function(){balkskesVoorActiviteit.fadeTo(0,1)});for(var i=0;i<balkskesVoorActiviteit.length;i++)if(i>0){var huidigBalkske=angular.element(balkskesVoorActiviteit[i]),vorigBalkske=angular.element(balkskesVoorActiviteit[i-1]);0!=huidigBalkske.parent().parent().index()&&huidigBalkske.addClass("herhaling");for(var dummyBalkske='<div class="kalenderActiviteit" style="visibility:collapse;">dummy</div>';huidigBalkske[0].offsetTop<vorigBalkske[0].offsetTop;)angular.element(huidigBalkske).parent().prepend(dummyBalkske);for(;vorigBalkske[0].offsetTop<huidigBalkske[0].offsetTop;)angular.element(balkskesVoorActiviteit[i-1]).parent().prepend(dummyBalkske)}})}}}}])}(),angular.module("awelzijn.kalender").run(["$templateCache",function($templateCache){$templateCache.put("templates/kalender.html",'<div> <div class=kalender> <table> <thead> <tr class=placeholder ng-show=ctrl.loading> <th><center>Activiteiten laden...</center></th> </tr> <tr ng-hide=ctrl.loading> <th>ma<span>andag</span></th> <th>di<span>nsdag</span></th> <th>wo<span>ensdag</span></th> <th>do<span>nderdag</span></th> <th>vr<span>ijdag</span></th> <th>za<span>terdag</span></th> <th>zo<span>ndag</span></th> </tr> </thead> <tbody> <tr class=placeholder ng-show=ctrl.loading> <td><center><i class="fa fa-spinner fa-spin"></i></center></td> </tr> <tr ng-hide=ctrl.loading ng-repeat="week in ctrl.kalender.weken"> <td ng-click="ctrl.geselecteerdeDag = dag" ng-repeat="dag in week" ng-class="{\'buiten_bereik\': (dag.isBuitenBereik || dag.datum.getDay() == 0 || dag.datum.getDay() == 6), \'heeftActiviteiten\': dag.activiteiten.length > 0, \'geselecteerdeDag\': ctrl.geselecteerdeDag == dag && dag.activiteiten.length > 0}"> <div class=datum> <span class=large ng-show=dag.eersteOfLaatsteVanMaand>{{dag.datum | date:\'MMMM\'}} </span>\n<span class=small ng-show=dag.eersteOfLaatsteVanMaand>{{dag.datum | date:\'MMM\'}} </span>\n{{dag.datum | date:\'dd\'}} </div> <div ng-if="dag.activiteiten.length > 0" class=heeftActiviteiten></div> <div ng-if=dag.activiteiten class=toon-info> <div a-welzijn-navigate-on-click state=activiteit.detail params={id:activiteit.id} ng-repeat="activiteit in dag.activiteiten" class="kalenderActiviteit {{activiteit.id}}"> <div><input ng-click=$event.stopPropagation(); type=checkbox ng-model="activiteit.checked">{{activiteit.naam}}</div> </div> </div> </td> </tr> </tbody> </table> <div class=activiteitenPerDag ng-show=ctrl.geselecteerdeDag> <div a-welzijn-navigate-on-click state=activiteit.detail params={id:activiteit.id} class="activiteit hover clearfix" ng-repeat="activiteit in ctrl.geselecteerdeDag.activiteiten"> <div> <input ng-click=$event.stopPropagation(); ng-model=activiteit.checked type=checkbox>\n<span>{{activiteit.naam}}</span> </div> <div> <span class=smaller>{{activiteit.datumVan | date:\'EEE dd MMM\'}}</span>\n<span>{{activiteit.datumVan | date:\'HH:mm\'}}</span> <div ng-show="activiteit.datums.length > 1"> <span>tot</span>\n<span class=smaller>{{activiteit.datumTot | date:\'EEE dd MMM\'}}</span>\n<span>{{activiteit.datumTot | date:\'HH:mm\'}}</span> </div> </div> </div> </div> </div> </div>')}]);
//# sourceMappingURL=awelzijn-kalender.min.map